"use strict";angular.module("app",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ui.echarts","ui.router","ui.bootstrap","ui.load","ui.jq","ui.validate","oc.lazyLoad","cgBusy"]);
var app=angular.module("app").config(["$controllerProvider","$compileProvider","$filterProvider","$provide",function(r,e,a,c){app.controller=r.register,app.directive=e.directive,app.filter=a.register,app.factory=c.factory,app.service=c.service,app.constant=c.constant,app.value=c.value}]).factory("cache",["$cacheFactory",function(r){return r("cache")}]);
angular.module("app").constant("JQ_CONFIG",{footable:["lib/footable/dist/footable.all.min.js","lib/footable/css/footable.core.min.css"]});
"use strict";angular.module("app").run(["$rootScope","$state","$stateParams",function(t,e,l){t.$state=e,t.$stateParams=l}]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/app/livechannels"),t.state("app",{"abstract":!0,url:"/app",templateUrl:"tpl/app.html"}).state("app.default",{url:"/default",templateUrl:"tpl/default.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/rating.js"])}]}}).state("app.liveChannels",{url:"/livechannels",templateUrl:"tpl/live_channels.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/live.js"])}]}}).state("app.liveChannelDetail",{url:"/livechannels/:id",templateUrl:"tpl/live_channels_detail.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/live.js"])}]}}).state("app.channels",{url:"/channels",templateUrl:"tpl/channels.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/channels.js"])}]}}).state("app.channelDetail",{url:"/channels/:id",templateUrl:"tpl/channels_detail.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/channels.js"])}]}}).state("app.tvshows",{url:"/tvshows",templateUrl:"tpl/tvshows.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/tvshows.js"])}]}}).state("app.tvshowDetail",{url:"/tvshows/{typeid}/{showid}",templateUrl:"tpl/tvshows_detail.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/tvshows.js"])}]}}).state("app.tvshowRating",{url:"/tvshow/:showid",templateUrl:"tpl/tvshow_rating.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/tvshows.js"])}]}}).state("app.io",{url:"/io",templateUrl:"tpl/io.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/io.js"])}]}}).state("app.liveClients",{url:"/liveclients",templateUrl:"tpl/live_clients.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/map.js"])}]}}).state("app.totleClients",{url:"/totalclients",templateUrl:"tpl/total_clients.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/map.js"])}]}}).state("app.audiences",{url:"/audiences",templateUrl:"tpl/audiences.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/rating.js"])}]}}).state("app.housingPrice",{url:"/housingprice",templateUrl:"tpl/housing_price.html"}).state("app.audiencesTag",{url:"/audiences/tag",templateUrl:"tpl/audiences_tag.html"}).state("app.adCategories",{url:"/adcategories",templateUrl:"tpl/ad_categories.html"}).state("app.adCategories2rd",{url:"/adcategories/:id",templateUrl:"tpl/ad_categories_2rd.html"}).state("app.adBrands",{url:"/adbrands",templateUrl:"tpl/ad_brands.html"}).state("app.adBrands2rd",{url:"/adbrands/:id",templateUrl:"tpl/ad_brands_2rd.html"}).state("app.liveAd",{url:"/livead",templateUrl:"tpl/livead.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/ad.js"])}]}}).state("app.ChannelAd",{url:"/channelad",templateUrl:"tpl/channelad.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/ad.js"])}]}}).state("app.CategoryAd",{url:"/categoryad",templateUrl:"tpl/categoryad.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/ad.js"])}]}}).state("app.BrandAd",{url:"/brandad",templateUrl:"tpl/brandad.html",resolve:{deps:["$ocLazyLoad",function(t){return t.load(["js/controllers/ad.js"])}]}}).state("app.help",{url:"/help",templateUrl:"tpl/help.html"}).state("app.about",{url:"/about",templateUrl:"tpl/about.html"})}]);
"use strict";angular.module("app").controller("AppCtrl",["$scope","$rootScope","$http","$window","kuChannels",function(e,a,n,o,r){function i(e){var a=e.navigator.userAgent||e.navigator.vendor||e.opera;return/iPhone|iPod|iPad|Silk|Android|BlackBerry|Opera Mini|IEMobile/.test(a)}var t=!!navigator.userAgent.match(/MSIE/i);t&&angular.element(o.document.body).addClass("ie"),i(o)&&angular.element(o.document.body).addClass("smart"),e.app={name:"KY野榜",version:"0.0.3",color:{primary:"#7266ba",info:"#23b7e5",success:"#27c24c",warning:"#fad733",danger:"#f05050",light:"#e8eff0",dark:"#3a3f51",black:"#1c2b36"},settings:{themeID:1,navbarHeaderColor:"bg-black",navbarCollapseColor:"bg-white-only",asideColor:"bg-black",headerFixed:!0,asideFixed:!0,asideFolded:!1,asideDock:!1,container:!1}},e.isXSmallDevice=function(){return"none"!=$("#xs-test").css("display")},r.getChannels(function(e){$.extend(a,e)})}]);
angular.module("app").directive("setNgAnimate",["$animate",function(n){return{link:function(e,t,a){e.$watch(function(){return e.$eval(a.setNgAnimate,e)},function(e){n.enabled(!!e,t)})}}}]);
angular.module("app").directive("uiButterbar",["$rootScope","$anchorScroll",function(a,e){return{restrict:"AC",template:'<span class="bar"></span>',link:function(a,t){t.addClass("butterbar hide"),a.$on("$stateChangeStart",function(){e(),t.removeClass("hide").addClass("active")}),a.$on("$stateChangeSuccess",function(a){a.targetScope.$watch("$viewContentLoaded",function(){t.addClass("hide").removeClass("active")})})}}}]);
"use strict";angular.module("ui.echarts",["ui.load"]).directive("uiEcharts",["uiLoad",function(i){return{restrict:"EA",template:"<div></div>",replace:!0,scope:{option:"=option"},link:function(t,n){t.$watch("option",function(){var o=function(){var i=echarts.init(n[0]);i.setOption(t.option),window.onresize=i.resize};window.echarts?o():i.load(["js/lib/echarts-all.js"]).then(function(){o()})["catch"](function(){})})}}}]);
angular.module("app").directive("uiFocus",function(n,u){return{link:function(i,c,o){var t=u(o.uiFocus);i.$watch(t,function(u){u===!0&&n(function(){c[0].focus()})}),c.bind("blur",function(){i.$apply(t.assign(i,!1))})}}});
angular.module("app").directive("uiFullscreen",["uiLoad","$document","$window",function(e,n){return{restrict:"AC",template:'<i class="fa fa-expand fa-fw text"></i><i class="fa fa-compress fa-fw text-active"></i>',link:function(a,l,t){l.addClass("hide"),e.load("lib/screenfull/dist/screenfull.min.js").then(function(){screenfull.enabled&&!navigator.userAgent.match(/Trident.*rv:11\./)&&l.removeClass("hide"),l.on("click",function(){var e;t.target&&(e=$(t.target)[0]),screenfull.toggle(e)}),n.on(screenfull.raw.fullscreenchange,function(){screenfull.isFullscreen?l.addClass("active"):l.removeClass("active")})})}}}]);
"use strict";angular.module("ui.jq",["ui.load"]).value("uiJqConfig",{}).directive("uiJq",["uiJqConfig","JQ_CONFIG","uiLoad","$timeout",function(i,n,u,t){return{restrict:"A",compile:function(e,o){if(!angular.isFunction(e[o.uiJq])&&!n[o.uiJq])throw new Error('ui-jq: The "'+o.uiJq+'" function does not exist');var r=i&&i[o.uiJq];return function(i,e,o){function c(){var n=[];return o.uiOptions?(n=i.$eval("["+o.uiOptions+"]"),angular.isObject(r)&&angular.isObject(n[0])&&(n[0]=angular.extend({},r,n[0]))):r&&(n=[r]),n}function a(){t(function(){e[o.uiJq].apply(e,c())},0,!1)}function f(){o.uiRefresh&&i.$watch(o.uiRefresh,function(){a()})}o.ngModel&&e.is("select,input,textarea")&&e.bind("change",function(){e.trigger("input")}),n[o.uiJq]?u.load(n[o.uiJq]).then(function(){a(),f()})["catch"](function(){}):(a(),f())}}}}]);
angular.module("app").directive("uiModule",["MODULE_CONFIG","uiLoad","$compile",function(n,e,o){return{restrict:"A",compile:function(t){var u=t.contents().clone();return function(t,i,c){i.contents().remove(),e.load(n[c.uiModule]).then(function(){o(u)(t,function(n){i.append(n)})})}}}}]);
angular.module("app").directive("uiNav",["$timeout",function(){return{restrict:"AC",link:function(e,a){var t,o=$(window),n=768,s=$(".app-aside"),i=".dropdown-backdrop";a.on("click","a",function(e){t&&t.trigger("mouseleave.nav");var a=$(this);a.parent().siblings(".active").toggleClass("active"),a.next().is("ul")&&a.parent().toggleClass("active")&&e.preventDefault(),a.next().is("ul")||o.width()<n&&$(".app-aside").removeClass("show off-screen")}),a.on("mouseenter","a",function(e){if(t&&t.trigger("mouseleave.nav"),$("> .nav",s).remove(),!(!$(".app-aside-fixed.app-aside-folded").length||o.width()<n||$(".app-aside-dock").length)){var a,r=$(e.target),p=$(window).height(),v=50,c=150;!r.is("a")&&(r=r.closest("a")),r.next().is("ul")&&(t=r.next(),r.parent().addClass("active"),a=r.parent().position().top+v,t.css("top",a),a+t.height()>p&&t.css("bottom",0),a+c>p&&t.css("bottom",p-a-v).css("top","auto"),t.appendTo(s),t.on("mouseleave.nav",function(){$(i).remove(),t.appendTo(r.parent()),t.off("mouseleave.nav").css("top","auto").css("bottom","auto"),r.parent().removeClass("active")}),$(".smart").length&&$('<div class="dropdown-backdrop"/>').insertAfter(".app-aside").on("click",function(e){e&&e.trigger("mouseleave.nav")}))}}),s.on("mouseleave",function(){t&&t.trigger("mouseleave.nav"),$("> .nav",s).remove()})}}}]);
angular.module("app").directive("uiScroll",["$location","$anchorScroll",function(c,n){return{restrict:"AC",link:function(i,l,o){l.on("click",function(){c.hash(o.uiScroll),n()})}}}]);
angular.module("app").directive("uiShift",["$timeout",function(i){return{restrict:"A",link:function(n,t,e){function r(){i(function(){var i=e.uiShift,n=e.target;o.hasClass("in")||o[i](n).addClass("in")})}function u(){a&&a.prepend(t),!a&&o.insertAfter(f),o.removeClass("in")}var a,o=$(t),d=$(window),f=o.prev(),s=d.width();!f.length&&(a=o.parent()),768>s&&r()||u(),d.resize(function(){s!==d.width()&&i(function(){d.width()<768&&r()||u(),s=d.width()})})}}}]);
angular.module("app").directive("uiToggleClass",["$timeout","$document",function(){return{restrict:"AC",link:function(e,t,a){t.on("click",function(e){function l(e,t){for(var a=new RegExp("\\s"+e.replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g"),l=" "+$(t)[0].className+" ";a.test(l);)l=l.replace(a," ");$(t)[0].className=$.trim(l)}e.preventDefault();var n=a.uiToggleClass.split(","),s=a.target&&a.target.split(",")||Array(t),i=0;angular.forEach(n,function(e){var t=s[s.length&&i];-1!==e.indexOf("*")&&l(e,t),$(t).toggleClass(e),i++}),$(t).toggleClass("active")})}}}]);
"use strict";angular.module("ui.validate",[]).directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(a,n,i,t){function u(n){return angular.isString(n)?void a.$watch(n,function(){angular.forEach(l,function(a){a(t.$modelValue)})}):angular.isArray(n)?void angular.forEach(n,function(n){a.$watch(n,function(){angular.forEach(l,function(a){a(t.$modelValue)})})}):void(angular.isObject(n)&&angular.forEach(n,function(n,i){angular.isString(n)&&a.$watch(n,function(){l[i](t.$modelValue)}),angular.isArray(n)&&angular.forEach(n,function(n){a.$watch(n,function(){l[i](t.$modelValue)})})}))}var r,l={},e=a.$eval(i.uiValidate);e&&(angular.isString(e)&&(e={validator:e}),angular.forEach(e,function(n,i){r=function(u){var r=a.$eval(n,{$value:u});return angular.isObject(r)&&angular.isFunction(r.then)?(r.then(function(){t.$setValidity(i,!0)},function(){t.$setValidity(i,!1)}),u):r?(t.$setValidity(i,!0),u):(t.$setValidity(i,!1),u)},l[i]=r,t.$formatters.push(r),t.$parsers.push(r)}),i.uiValidateWatch&&u(a.$eval(i.uiValidateWatch)))}}});
"use strict";angular.module("app").filter("fromNow",function(){return function(t){return moment(t).fromNow()}}),angular.module("app").filter("kuDate",function(){return function(t,n){return moment(t).format(n)}}),angular.module("app").filter("dateFormat",function(){return function(t,n){return" ".indexOf(t)?moment(t).format(n):moment(t,"YYYYMMDDHHmmss").format(n)}});
"use strict";angular.module("ngLocale",[],["$provide",function(e){var a={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["上午","下午"],DAY:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],MONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],SHORTMONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d ah:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"ah:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"¥",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(¤",negSuf:")",posPre:"¤",posSuf:""}]},id:"zh-cn",pluralCat:function(){return a.OTHER}})}]);
"use strict";angular.module("app").service("kuChannels",["$http","$cacheFactory","$q","$timeout","cache",function(t,e,n,a,i){this.getChannels=function(e){var n=function(t,e){return{channelIDs:t,channels:e}};i.get("channels")?e(n(i.get("channelIDs"),i.get("channels"))):t.get("/fapi/channels.json").success(function(t){var a,i={};for(a=0;a<t.length;a++)i[t[a].id]={id:t[a].id,name:t[a].name,type:t[a].type};e(n(i,t))})},this.getLiveTopChannels=function(){var e=t.get("/api/channel_list");return e},this.getTopChannels=function(e,n){var a=moment(e).format("YYYY-MM-DD"),i="/api/tv_ratings_rank?type="+n+"&start_ds="+a+"&end_ds="+a,r=t.get(i);return r},this.getLiveRating=function(e,n){var a="/api/ratings_"+e+"?tv_id="+n,i=t.get(a);return i},this.getRating=function(e,n,a){var i=moment(e).format("YYYY-MM-DD"),r=moment(n).format("YYYY-MM-DD"),s="/labapi/ratings_history?tv_id="+a+"&start_ds="+i+"&end_ds="+r;return t.get(s)},this.getEPG=function(e,n,a){var i=moment(e).format("YYYY-MM-DD"),r=moment(n).format("YYYY-MM-DD"),s="api/ratings_epg_history?tv_id="+a+"&start_ds="+i+"&end_ds="+r+"&page_no=1&page_size=65";return t.get(s)},this.getIO=function(e,n,a,i){var e=moment(e).format("YYYY-MM-DD "),n=e+moment(n).format("HH:mm:ss"),a=e+moment(a).format("HH:mm:ss"),r="/labapi/tv_io?tv_id="+i+"&start_time="+n+"&end_time="+a;return t.get(r)}}]),angular.module("app").service("kuTVShows",["$http","$timeout",function(t){this.getTopTVShows=function(e,n){var a=moment(e).format("YYYY-MM-DD"),i="api/epg_sort?type="+n+"&date="+a;return t.get(i)},this.getRating=function(e,n){var a="/api/epg_detail_ratings?type="+e+"&ca_id="+n;return t.get(a)},this.getEPG=function(e,n){var a="/api/epg_detail?ca_id="+n+"&page_size=150&type="+e;return t.get(a)},this.getGeo=function(e){return t.get("/api/rating_province?epg_id="+e)}}]),angular.module("app").service("kuAds",["$http","$timeout",function(t){this.getLiveADs=function(e){var n="labapi/ad_list?start_time=2014-12-05%2019:00:00&end_time=2015-12-05%2023:00:00&tv_id=";return e&&(n+=e),t.get(n)},this.getCategoryADs=function(){var e="/fapi/ad/categoryAds.json";return t.get(e)},this.getBrandADs=function(){var e="/fapi/ad/brandAds.json";return t.get(e)},this.getChannelADs=function(){var e="/fapi/ad/channelAds.json";return t.get(e)}}]);
"use strict";angular.module("ui.load",[]).service("uiLoad",["$document","$q","$timeout",function(e,r,n){var t=[],o=!1,i=r.defer();this.load=function(e){e=angular.isArray(e)?e:e.split(/\s+/);var r=this;return o||(o=i.promise),angular.forEach(e,function(e){o=o.then(function(){return e.indexOf(".css")>=0?r.loadCSS(e):r.loadScript(e)})}),i.resolve(),o},this.loadScript=function(o){if(t[o])return t[o].promise;var i=r.defer(),u=e[0].createElement("script");return u.src=o,u.onload=function(e){n(function(){i.resolve(e)})},u.onerror=function(e){n(function(){i.reject(e)})},e[0].body.appendChild(u),t[o]=i,i.promise},this.loadCSS=function(o){if(t[o])return t[o].promise;var i=r.defer(),u=e[0].createElement("link");return u.rel="stylesheet",u.type="text/css",u.href=o,u.onload=function(e){n(function(){i.resolve(e)})},u.onerror=function(e){n(function(){i.reject(e)})},e[0].head.appendChild(u),t[o]=i,i.promise}}]);